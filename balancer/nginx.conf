events {
    worker_connections 2048;
}

http {
    upstream apps {
        server localhost:8080;
        server 185.130.112.13:80;
        server 87.239.108.31:80;
    }

    upstream prom_metrics {
        server localhost:9090;
    }

    upstream graf_metrics {
        server localhost:3000;
    }

    server {
        listen 80;
    
        location /prometheus/ {
            proxy_pass http://prom_metrics;
        }

        location /grafana/ {
            proxy_pass http://graf_metrics;
        }

        location / {
            proxy_pass http://apps;
        }
    }
}
