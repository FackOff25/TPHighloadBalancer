events {
    worker_connections 2048;
}

stream {
    upstream app_node {
        server localhost:8080;
        server 185.130.112.13:80;
        server 87.239.108.31:80;
    }

    upstream prom_metrics {
        server localhost:9090;
    }

    upstream graf_metrics {
        server localhost:3000;
    }

    server {
        listen 80;
        proxy_pass app_node;
        

        location /prometheus/ {
            proxy_pass prom_metrics;
        }

        location /grafana/ {
            proxy_pass graf_metrics;
        }
    }
}
